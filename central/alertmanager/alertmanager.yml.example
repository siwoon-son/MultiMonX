# MultiMonX Alertmanager Configuration (템플릿)
# 사용: 이 파일을 alertmanager.yml 로 복사한 뒤 웹후크/이메일 URL 등을 수정하세요.
#   cp alertmanager.yml.example alertmanager.yml
#
# https://prometheus.io/docs/alerting/latest/configuration/

global:
  resolve_timeout: 5m

# Routing tree
route:
  group_by: ['alertname', 'instance', 'job']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  receiver: 'default'
  routes:
    - match:
        severity: critical
      receiver: 'critical'
      repeat_interval: 1h

receivers:
  - name: 'default'
    # 설정 없으면 알림은 UI에서만 확인. 아래 중 하나를 주석 해제 후 수정.

  - name: 'critical'
    # critical 알림용 receiver (필요 시 default 와 동일하게 설정)

# ----- Discord (주석 해제 후 URL 교체) -----
# receivers:
#   - name: 'default'
#     webhook_configs:
#       - url: 'https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_TOKEN'
#         send_resolved: true
#   - name: 'critical'
#     webhook_configs:
#       - url: 'https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_TOKEN'
#         send_resolved: true

# ----- Email (주석 해제 후 smarthost/auth 등 수정) -----
# receivers:
#   - name: 'default'
#     email_configs:
#       - to: 'ops@example.com'
#         from: 'alertmanager@example.com'
#         smarthost: 'smtp.example.com:587'
#         auth_username: 'alertmanager@example.com'
#         auth_password: 'your-password'
#         headers:
#           Subject: '[MultiMonX] {{ .GroupLabels.alertname }}'
